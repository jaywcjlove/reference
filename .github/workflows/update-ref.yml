name: æ¯æœˆæ›´æ–°ä¸€æ¬¡reference
on:
  schedule:
    - cron: '30 0 1 * *' # å®šæ—¶ä»»åŠ¡ æ¯8ä¸ªå°æ—¶æ›´æ–°ä¸€æ¬¡reference 21 */8 * * *
  workflow_dispatch:       # æ‰‹åŠ¨è¿è¡Œ

env: # è®¾ç½®ç¯å¢ƒå˜é‡
  TZ: Asia/Shanghai # æ—¶åŒºï¼ˆè®¾ç½®æ—¶åŒºå¯ä½¿é¡µé¢ä¸­çš„`æœ€è¿‘æ›´æ–°æ—¶é—´`ä½¿ç”¨æ—¶åŒºæ—¶é—´ï¼‰

jobs:
  build: # è‡ªå®šä¹‰åç§°
    runs-on: ubuntu-latest
    steps:
      - name: ğŸšœ æ‹‰å–æœ€æ–°ä»£ç 
        uses: actions/checkout@v3
        with:
          ref: 'main'
          repository: 'xushuyi888/reference'

      - name: â™»ï¸ ç¼–è¯‘é™æ€æ–‡ä»¶
        run: |
          echo -e 'REF_URL=https://ref.rootcs.cn/\nREF_LABEL=ç½‘ç«™é¦–é¡µ\nLICENSE=Copyright (c) <b>2023</b> xushuyiâ„¢ \nREF_FOOTER=å¤‡æ¡ˆå·ï¼š<a href="https://beian.miit.gov.cn/" target="_blank">ç²¤ICPå¤‡15067296å·-2</a>' > .env
          npm install
          npm run build

      - name: ğŸ‰å®‰è£…coscmd
        run: sudo pip install coscmd

      - name: ğŸ’¾ é…ç½®COS
        env:
          SECRET_ID: ${{ secrets.SECRET_ID }}
          SECRET_KEY: ${{ secrets.SECRET_KEY }}
          BUCKET: ${{ vars.BUCKET_NAME }}
          REGION: ap-guangzhou
        run: coscmd config -a $SECRET_ID -s $SECRET_KEY -b $BUCKET -r $REGION
      - name: ğŸš éƒ¨ç½²åˆ°è…¾è®¯äº‘COS
        run: coscmd upload -r ./dist/ / --ignore "./.git/*"